{{#section 'title'}}
	Edit Product
{{/section}}

{{#section 'css'}}
  	<link rel="stylesheet" type="text/css" href="/bootstrap-datepicker/css/bootstrap-datepicker3.min.css">
{{/section}}

{{#section 'js'}}
	<script src="/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
	<script type="text/javascript">

	function readURL(input) {
	  	if (input.files && input.files[0]) 
	  	{
	    	var reader = new FileReader();
	    	reader.onload = function(e) {
	     		$('#preview').attr('src', e.target.result);
	    	}
	    	reader.readAsDataURL(input.files[0]);
	  	}
	}

	$(function() {

		var datePattern = /^\d{2}[/]\d{2}[/]\d{4}$/;

		$('#txtDate').datepicker({
          format: 'dd/mm/yyyy',
          autoclose: true
        });

        $('#txtDate').change(function() {
          var date = $(this).val();
          if(!date.match(datePattern))
          {
            $(this)[0].setCustomValidity('Invalid Date!');
            $(this).css('border-color', 'red');
          }
          else 
          {
            $(this)[0].setCustomValidity("");
            $(this).css('border-color', 'green');
          }
        });

		$("#proImg").change(function() {
		  readURL(this);
		});

		$('#btnCancel').click(function(event) {
        	event.preventDefault();
        	swal({
			  title: 'Are you sure?',
			  text: "Cancel all changes?",
			  type: 'warning',
			  showCancelButton: true,
			  confirmButtonColor: '#3085d6',
			  cancelButtonColor: '#d33'
			}).then((result) => {
			  if (result.value) 
			  	$('#frmUpdate')[0].reset();
			});
        });

	});

	</script>

	{{#if isUpdate}}
        <script type="text/javascript">
          swal({
            type: 'success',
            title: 'Update Successfully',
            showConfirmButton: false,
            timer: 1500
          }).then((result) => {
              window.location.href = "/admin/products";
          });
        </script>
    {{/if}}

{{/section}}

{{#with Product}}
<form id="frmUpdate" action="" method="POST" role="form">
	<div class="card-simple overflow">
		<div class="row">
		    <div class="col-sm">
				<div class="form-group">
			    	<label for="proID">Product ID</label>
			    	<input type="text" class="form-control disabled" name="proID" value="{{ID}}">
			  	</div>
			  	<div class="form-group">
			    	<label for="proName">Product Name</label>
			    	<input type="text" class="form-control" name="proName" required value="{{Ten}}">
			  	</div>
			  	<br>
			 	<div class="form-group">
			    	<label for="proPic">Change Product Picture</label>
			    	<input type="file" class="form-control-file" name="proPic" id="proImg" accept="image/*">
			  	</div>
				<br>
				<img src="{{HinhAnh}}" id="preview"></img>
				<br>
				<div class="form-group">
			    	<label for="proPrice">Product Price</label>
			    	<input type="number" class="form-control" required name="proPrice" value="{{GiaBan}}">
			  	</div>
			  	<br>
			  	<div class="form-group">
			    	<label for="proViews">Views</label>
			    	<input type="number" class="form-control" required name="proViews" value="{{SoLuotXem}}">
			  	</div>
			  	<br>
				<div class="form-group">
			    	<label for="proInStore">In Store</label>
			    	<input type="number" class="form-control" required name="proInStore" value="{{SoLuongTon}}">
			  	</div>
			  	<br>
				<div class="form-group">
			    	<label for="proSold">Sold</label>
			    	<input type="number" class="form-control" required name="proSold" value="{{SoLuongBan}}">
			  	</div>
			  	<br>
		    </div>
		    <div class="col-sm">
				<div class="form-group">
			    	<label for="proDes">Description</label>
			    	<textarea class="form-control" rows="10" required name="proDes">{{MoTa}}</textarea>
			  	</div>
			  	<br>
				<div class="form-group">
			    	<label for="proCat">Category</label>
			    	<select class="form-control" name="proCat" id="selCat">
			    		{{#with ../ProCat}}
							<option value="{{ID}}">{{TenLoai}}</option>
			    		{{/with}}
			    		<option disabled>----------</option>
						{{#each ../Categories}}
				    		{{#if TrangThai}}
								<option value="{{ID}}">{{TenLoai}}</option>
							{{/if}}
				    	{{/each}}
				  	</select>
			  	</div>
			  	<br>
				<div class="form-group">
			    	<label for="proSup">Supplier</label>
			    	<select class="form-control" name="proSup" id="selSup">
			    		{{#with ../ProManu}}
							<option value="{{ID}}">{{TenNSX}}</option>
			    		{{/with}}
			    		<option disabled>----------</option>
				    	{{#each ../Suppliers}}
				    		{{#if TrangThai}}
								<option value="{{ID}}">{{TenNSX}}</option>
							{{/if}}
				    	{{/each}}
				  	</select>
			  	</div>
			  	<br>
				<div class="form-group">
			    	<label for="proDate">Date</label>
			    	<input type="text" class="form-control" required id="txtDate" name="proDate" 
			    	value="{{NgayTiepNhan}}">
			  	</div>
			  	
		    </div>  
		</div>

		<div class="col-md-4 text-center">
		    <button id="btnUpdate" type="submit" class="btn btn-primary">UPDATE</button>
		    <button id="btnCancel" type="reset" class="btn btn-primary">CANCEL</button>
		</div>
	</div>
</form>
{{/with}}